<!DOCTYPE html>

<html>

<head>
  <title>Assignment 8</title>

  <link rel="stylesheet" href="style.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <script src="Player.js"></script>
  <script src="Gun.js"></script>
  <script src="Shape.js"></script>
  <script src="Cloud.js"></script>
  <script src="Button.js"></script>
  <script src="utils.js"></script>

  <script type="text/javascript">

    // Globals variables
    var c, gc;
    var frame = 0;
    var waitingShapes = [];
    var runningShapes = [];
    var player;
    var gun;
    // var hit;
    var shooting = [];
    var clouds = [];

    // Shape colors
    var colors = ['#FFFF8D',
    							'#dff69e',
              		'#00ceff',
    							'#ee78aa',
              		'#3f159f',
              		'#71b583',
              		'#00a2ff'];

    <!-- onload Function -->
    window.onkeydown = function(e) {
      if (e.keyCode == 32 || e.keyCode == 38 && e.target == document.body) {
        e.preventDefault();
        player.setJumped(true);
      }
      else if (e.keyCode == 39 && e.target == document.body) {
        e.preventDefault();
        shooting.push(gun);
        // hit = true;
        gun.doShot(true);
        console.log('call doShot');
      }
    }

    window.onload = function() {
      // Set up canvas
      c = document.getElementById("MyCanvas");
      gc = c.getContext("2d");
      c.width = window.innerWidth;
      c.height = window.innerHeight-100;

      // Key event listener
      c.addEventListener('keydown', function(event) {
          if(event.keyCode == 32) {
              player.setJumped(true);
          }
          console.log("press the space bar");
      });
      c.focus();

      // Create Player and Gun
      player = new Player();
      // hit = false;
      gun = new Gun();

      // Create Shapes
      // createShape(20);

      // Create clouds
      for (var i=0; i<10; i++) {
        var cloud = new Cloud();
        clouds.push(cloud);
      }

      // Draw background, Player
      drawAll();

      // Add buttons
      new Button("Start");
      new Button("Stop");

      console.log("onload")
    }

    <!-- Function -->
    function drawBackground() {
      var grd=gc.createLinearGradient(0,75,0,750);
      grd.addColorStop(0,"#FFAFBD");
      grd.addColorStop(1,"#ffc3a0");
      gc.fillStyle = grd; //#43C6AC #FFAFBD #d3d3d3 #FFEB3B grd
      gc.fillRect(0, 0, c.width, c.height);
    }

    // Make new shape items and put them in waitingShapes array list
    function createShape(int) {
      console.log("call create shape");
      // Make an arrayList for containing all types of shapes
      var shapeType = [];
      shapeType.push("circle", "rectangle"); //"square", "ellipse", "triangle"

      // Get a random type of shape
      var randomShape = shapeType[Math.floor(Math.random() * shapeType.length)];

      for (var i=0; i<int; i++) {
        var shp;

        if (randomShape == "circle") {
          shp = new Circle();
        } else if (randomShape == "rectangle") {
          shp = new Rectangle();
        }
        // Put the initialized item in the arrayList
        waitingShapes.push(shp);
        console.log(i + " create shape")
      }
    }

    function launchShape() {
      console.log("call launch shape");
      // Make an arrayList for containing all types of shapes
      var shapeType = [];
      shapeType.push("circle", "rectangle"); //"square", "ellipse", "triangle"

      // Get a random type of shape
      var randomShape = shapeType[Math.floor(Math.random() * shapeType.length)];
      var shp;

      if (randomShape == "circle") {
        shp = new Circle();
      } else if (randomShape == "rectangle") {
        shp = new Rectangle();
      }
      // Put the initialized item in the arrayList
      runningShapes.push(shp);
    }

    function drawAll() {
      // Background
      drawBackground();

      // Clouds
      for (var i=0; i<clouds.length; i++) {
        var cloud = this.clouds[i];
        cloud.draw(gc);
      }

      // Player
      player.draw(gc);

      // Gun
      for (var i=0; i<shooting.length; i++) {
        var shot = this.shooting[i];
        shot.draw(gc);
      }

      // Shape
      for (var i=0; i< runningShapes.length; i++) {
        var shape = this.runningShapes[i];
        shape.draw(gc);
      }
    }

    function tick() {
      frame ++;

      // Player
      player.tick();

      // Gun
      for (var i=0; i<shooting.length; i++) {
        var shot = this.shooting[i];
        shot.tick(gc);
      }

      // Clouds
      for (var i=0; i< clouds.length; i++) {
        var cloud = this.clouds[i];
        cloud.tick();
      }

      // Shapes
      for (var i=0; i< runningShapes.length; i++) {
        var shape = this.runningShapes[i];
        shape.tick();
      }

      // Redraw all with updated data
      drawAll();
      setTimeout(tick, 100); // 100 msec
    }

    // func  tion select(event) {
    //   var x = event.clientX;
    //   var y = event.clientY;
    //   var rect = c.getBoundingClientRect();
    //   var collide = false;
    //
    //   for (i = 0; i < animals.length; i++) {
    //     var boundX = animals[i].x - (animals[i].size / 2);
    //     var boundY = animals[i].y - (animals[i].size / 2);
    //
    //     if (boundX <= x + rect.left && x + rect.left <= (boundX + animals[i].size) &&
    //       boundY <= y - rect.top && y - rect.top <= (boundY + animals[i].size)) {
    //       selected = animals[i];
    //       collide = true;
    //
    //       document.getElementById("statusmsg").innerHTML =
    //         "Mouse down at " + event.clientX + ", " + event.clientY;
    //       break;
    //     }
    //   }
    //   if (!collide) {
    //     create(event);
    //     selected = null;
    //
    //     document.getElementById("statusmsg").innerHTML =
    //       "Mouse down at " + event.clientX + ", " + event.clientY;
    //   }
    //   update();
    // }
  </script>

</head>

<body>
  <div id="title">
    <h1>Assignment 8</h1>
  </div>
  <canvas id="MyCanvas" ></canvas>
  <div id="buttonarea">
    &nbsp;
  </div>
  <p><b>Status: </b></b><span id="statusmsg">(Nothing Here)</span></p>
  <p><b>Animal Count: </b></b><span id="count">0</span></p>
  <p><b>Selected Animal: </b></b><span id="selected" style="font-size:60px;"></span></p>
</body>

</html>
